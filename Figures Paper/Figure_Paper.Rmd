---
title: "Figure Paper"
author: "Valeria Policastro"
date: "20 settembre 2019"
output:
  pdf_document: default
  word_document: default
---
#Fig.3 Plot of the two curves for the robustness
```{r}
library("cowplot")
library("robin")
library("gprege")
my_network <- system.file("example/football.gml", package="robin")
graph <- prepGraph(file=my_network, file.format="gml")
graphRandom <- random(graph=graph)
proc <- robinRobust(graph=graph, graphRandom=graphRandom, measure="vi", 
                  method="louvain", type="independent")
jpeg(file= "PlotRobin.jpeg")
plotRobin(graph=graph, model1=proc$Mean, model2=proc$MeanRandom, 
legend=c("real data", "null model"), measure="vi")
dev.off()
```

#Fig.4 Plot for the comparison of the two algorithms 
```{r}
comp <- robinCompare(graph=graph, method1="fastGreedy",
                method2="louvain", measure="vi", type="independent")
jpeg(file= "PlotCompare.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("fastGreedy", "louvain"), title="FastGreedy vs Louvain")
dev.off()
```

#Fig.5 Functional Data Analysis Test
```{r}

robinFDATest(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi")

```

#Fig.6 VI measure for all algorithms
```{r}
#1
comp <- robinCompare(graph=graph, method1="louvain",
                method2="fastGreedy", measure="vi", type="independent")
jpeg(file= "PlotFastGreedy.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "fastGreedy"), title="Louvain vs FastGreedy")
dev.off()
#2
comp <- robinCompare(graph=graph, method1="louvain",
                method2="walktrap", measure="vi", type="independent")
jpeg(file= "PlotWalktrap.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "walktrap"), title="Louvain vs Walktrap")
dev.off()
#3
comp <- robinCompare(graph=graph, method1="louvain",
                method2="labelProp", measure="vi", type="independent")
jpeg(file= "PlotLabelProp.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "labelProp"), title="Louvain vs LabelProp")
dev.off()
#4
comp <- robinCompare(graph=graph, method1="louvain",
                method2="leadingEigen", measure="vi", type="independent")
jpeg(file= "PlotLeadingEigen.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "leadingEigen"), title="Louvain vs LeadingEigen")
dev.off()
#5
comp <- robinCompare(graph=graph, method1="louvain",
                method2="infomap", measure="vi", type="independent")
jpeg(file= "PlotInfomap.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "infomap"), title="Louvain vs Infomap")
dev.off()
#6
comp <- robinCompare(graph=graph, method1="louvain",
                method2="edgeBetweenness", measure="vi", type="independent")
jpeg(file= "PlotEdgeBetwenness.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "edgeBetweenness"), title="Louvain vs EdgeBetweenness")
dev.off()
#7
comp <- robinCompare(graph=graph, method1="louvain",
                method2="spinglass", measure="vi", type="independent")
jpeg(file= "PlotSpinglass.jpeg")
plotRobin(graph=graph, model1=comp$Mean1, model2=comp$Mean2, measure="vi", 
legend=c("louvain", "spinglass"), title="Louvain vs Spinglass")
dev.off()

```

#Fig.7 Different Measures with simulated data (algorithm louvain) 
```{r}
list.filenames<-list.files(pattern=".edgelist")
BayesFactorVI<-NULL
BayesFactorNMI<-NULL
BayesFactorsplitjoin<-NULL
BayesFactoradjrand<-NULL
for (i in 1:length(list.filenames))
{
file<-list.filenames[i]
graph<-prepGraph(file, file.format ="edgelist",numbers = TRUE)
graph

graphRandom <- random(graph)
graphRandom

#VI
Proc <-robinRobust(graph=graph,graphRandom=graphRandom, method="louvain",
                       type="independent",measure = "vi")
BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactorVI<-rbind(BayesFactorVI,df)


#NMI
Proc <-robinRobust(graph=graph,graphRandom=graphRandom, method="louvain",
                 type="independent",measure = "nmi")
BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactorNMI<-rbind(BayesFactorNMI,df)

#split-join
Proc <-robinRobust(graph=graph,graphRandom=graphRandom, method="louvain",
                 type="independent",measure = "split.join")
BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactorsplitjoin<-rbind(BayesFactorsplitjoin,df)

#adj rand
Proc <-robinRobust(graph=graph,graphRandom=graphRandom, method="louvain",
                 type="independent",measure = "adjusted.rand")
BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactoradjrand<-rbind(BayesFactoradjrand,df)

}

x<-seq(0,0.8,0.025)

####VI
dfVI<-data.frame(BayesFactorVI$BF,x)
jpeg(file= "PlotVI.jpeg")
ggplot(data=dfVI, aes(x=x, y=BayesFactorVI$BF, group=1)) +
    geom_line(color=" blue")+
    geom_point(color=" blue")+
    xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("VI")
dev.off()

###NMI
dfNMI<-data.frame(BayesFactorNMI$BF,x)
jpeg(file= "PlotNMI.jpeg")
ggplot(data=dfNMI, aes(x=x, y=BayesFactorNMI$BF, group=1)) +
    geom_line(color=" blue")+
    geom_point(color=" blue")+
     xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("NMI")
dev.off()


###Adj rand 
dfAdj<-data.frame(BayesFactoradjrand$BF,x)
jpeg(file= "PlotAdj.jpeg")
ggplot(data=dfAdj, aes(x=x, y=BayesFactoradjrand$BF, group=1)) +
    geom_line(color=" blue")+
    geom_point(color=" blue")+
    xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("Adjusted Rand Index")
dev.off()

####split join
dfsplit<-data.frame(BayesFactorVSModularitysplitjoin$BF,x)
jpeg(file= "PlotSplit.jpeg")
ggplot(data=dfsplit, aes(x=x, y=BayesFactorsplitjoin$BF, group=1)) +
    geom_line(color="blue")+
    geom_point(color="blue")+
    xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("Split-join")
dev.off()
```

#Fig.8 Dependent vs Independent type
```{r}
#1
list.filenames<-list.files(pattern=".edgelist")
BayesFactorInd<-NULL
for (i in 1:length(list.filenames))
{
file <- list.filenames[i]
graph <- prepGraph(file, header=FALSE) 
graphRandom <- random(graph)
Proc <- robinRobust(graph=graph, graphRandom=graphRandom, measure="vi", 
                  method="louvain", type="independent")

BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactorInd<-rbind(BayesFactorInd,df)
}

x<-seq(0,0.8,0.025)
dfI<-data.frame(BayesFactorInd,x)
jpeg("Independent.jpeg")
ggplot(data=dfI, aes(x=x, y=BF, group=1)) +
    geom_line(color="dark blue")+
    xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("Independent")
dev.off()

#2
list.filenames<-list.files(pattern=".edgelist")
BayesFactorDep<-NULL
for (i in 1:length(list.filenames))
{
file <- list.filenames[i]
graph <- prepGraph(file, header=FALSE) 
graphRandom <- random(graph)
Proc <- robinRobust(graph=graph, graphRandom=graphRandom, measure="vi", 
                  method="louvain", type="dependent")

BF<-robinGPTest(ratio=Proc$ratios)
df<-data.frame(file,BF)
BayesFactorDep<-rbind(BayesFactorDep,df)
}

jpeg("Dependent.jpeg")
dfDep<-data.frame(BayesFactorVSModularity,x)
ggplot(data=dfDep, aes(x=x, y=BF, group=1)) +
    geom_line(color="dark blue")+
    xlab("Modularity") +
    ylab("BayesFactor") +
    ggtitle("Dependent")
dev.off()
```


